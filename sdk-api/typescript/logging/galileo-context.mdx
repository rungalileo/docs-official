---
title: Log Function Wrapper
icon: "box"
---

The `log` function wrapper allows you to wrap functions with spans of different types. This is useful for creating workflow spans with nested LLM calls or tool spans.

## Use Cases

The `log` function wrapper can be useful for:

- Creating workflow spans that can contain nested LLM calls or other spans
- Marking functions as tool spans to track tool usage
- Creating retriever spans to track document retrieval operations
- Automatically capturing the input and output of functions

## Usage

```typescript
import { log, init } from "galileo-experimental";

// Initialize Galileo
init({
  projectName: "my-project",
  logStreamName: "development"
});

const wrappedFunc = log(
  { name: 'workflow span' }, 
  (input) => {
    // Your code here
    return result;
  }
);

const result = wrappedFunc('input data');
```

## Examples

### Basic Example

Using the log wrapper to create a workflow span with nested LLM and tool spans:

```typescript
import { OpenAI } from "openai";
import { wrapOpenAI, flush, log, init } from 'galileo-experimental';

const openai = wrapOpenAI(new OpenAI({ apiKey: process.env.OPENAI_API_KEY }));

// This will automatically create an llm span since we're using the `wrapOpenAI` wrapper
const callOpenAI = async (input) => {
  const result = await openai.chat.completions.create({
    model: 'gpt-4o',
    messages: [{ content: `Say hello ${input}!`, role: 'user' }]
  });
  return result;
};

// Optionally initialize the logger if you haven't set GALILEO_PROJECT and GALILEO_LOG_STREAM environment variables
await init({
  projectName: 'my-test-project',
  logStreamName: 'my-test-log-stream'
});

const wrappedToolCall = log(
  { name: 'tool span', spanType: 'tool' },
  (input) => {
    return 'tool call result';
  }
);

const wrappedFunc = await log({ name: 'workflow span' }, async (input) => {
  const result = await callOpenAI(input);
  return wrappedToolCall(result);
});

// This will create a workflow span with an llm span and a tool span
const result = await wrappedFunc('world');

await flush();
```

### Retriever Example

Creating a retriever span to track document retrieval:

```typescript
import { log, init, flush } from "galileo-experimental";

// Initialize Galileo
init({
  projectName: "my-project",
  logStreamName: "development"
});

const retriever = log(
  { name: 'document retriever', spanType: 'retriever' },
  (query) => {
    // Retrieval logic
    return ["Document 1", "Document 2"];
  }
);

const documents = retriever("search query");

await flush();
```

## Span Types

The `log` function wrapper supports different span types:

- **workflow**: A span that can have child spans, useful for nesting several child spans to denote a thread within a trace. If you wrap a parent function with `log`, calls that are made within that scope are automatically logged in the same trace.
- **llm**: Captures the input, output, and settings of an LLM call. This span gets automatically created when our client library wrappers (OpenAI and Anthropic) are used. Cannot have nested children.
- **retriever**: Contains the output documents of a retrieval operation.
- **tool**: Captures the input and output of a tool call. Used to decorate functions that are invoked as tools.

## API Reference

### log

```typescript
function log<T>(
  options: {
    name?: string;
    spanType?: "workflow" | "llm" | "retriever" | "tool";
    metadata?: Record<string, any>;
  },
  fn: (...args: any[]) => T
): (...args: any[]) => T
```

Wraps a function and logs its execution as a span.

#### Parameters

- `options`: Configuration options for the span
  - `name`: The name of the span
  - `spanType`: The type of span to create (default: "workflow")
  - `metadata`: Additional metadata to include in the span
- `fn`: The function to wrap

#### Returns

A wrapped function that, when called, will log its execution as a span.