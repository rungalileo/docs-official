---
title: Log Function Wrapper
icon: "eye"
---

The `log` function wrapper allows you to wrap functions with spans of different types. It serves two main purposes:

1. It tells our logger to wrap the function contents as a span (you can specify the type in the first argument - by default a workflow span is created).
2. If there is no current trace when you execute a function wrapped in `log`, it will create a single span trace.

## Usage

```typescript
import { log, init, flush } from "galileo-experimental";

// Initialize Galileo
init({
  projectName: "my-project",
  logStreamName: "development"
});

const wrappedFunc = log(
  { name: 'workflow span', spanType: 'workflow' },
  (input) => {
    // Your function code here
    return `Processed: ${input}`;
  }
);

const result = wrappedFunc('test input');

// Flush logs before exiting
await flush();
```

## Span Types

The `log` function wrapper supports different span types:

- **workflow**: A span that can have child spans, useful for nesting several child spans to denote a thread within a trace. If you wrap a parent function with `log`, calls that are made within that scope are automatically logged in the same trace.
- **llm**: Captures the input, output, and settings of an LLM call. This span gets automatically created when our client library wrappers (OpenAI and Anthropic) are used. Cannot have nested children.
- **retriever**: Contains the output documents of a retrieval operation.
- **tool**: Captures the input and output of a tool call. Used to decorate functions that are invoked as tools.

## Examples

### Workflow Span with Nested LLM Calls

Create a trace with a workflow span and nested LLM spans:

```typescript
import { OpenAI } from "openai";
import { wrapOpenAI, flush, log, init } from 'galileo-experimental';

const openai = wrapOpenAI(new OpenAI({ apiKey: process.env.OPENAI_API_KEY }));

// This will automatically create an llm span since we're using the `wrapOpenAI` wrapper
const callOpenAI = async (input) => {
  const result = await openai.chat.completions.create({
    model: 'gpt-4o',
    messages: [{ content: `Say hello ${input}!`, role: 'user' }]
  });
  return result;
};

// Optionally initialize the logger if you haven't set GALILEO_PROJECT and GALILEO_LOG_STREAM environment variables
await init({
  projectName: 'my-test-project',
  logStreamName: 'my-test-log-stream'
});

const wrappedFunc = await log({ name: 'workflow span' }, async (input) => {
  const result1 = await callOpenAI(`${input} from France`);
  const result2 = await callOpenAI(`${input} from Germany`);
  return [result1, result2];
});

// This will create a workflow span with two llm spans
const results = await wrappedFunc('world');

await flush();
```

### Tool Span

Mark a function as a tool:

```typescript
import { log, init, flush } from "galileo-experimental";

// Initialize Galileo
init({
  projectName: "my-project",
  logStreamName: "development"
});

const wrappedToolCall = log(
  { name: 'tool span', spanType: 'tool' },
  (input) => {
    // Tool implementation
    return `Processed: ${input}`;
  }
);

const result = wrappedToolCall('test input');

// Flush logs before exiting
await flush();
```

### Retriever Span

Log a retriever function. If the output of the function is an array, it will automatically capture it as documents in the span:

```typescript
import { log, init, flush } from "galileo-experimental";

// Initialize Galileo
init({
  projectName: "my-project",
  logStreamName: "development"
});

const retriever = log(
  { name: 'document retriever', spanType: 'retriever' },
  (query) => {
    // Retrieval logic
    return [
      "Document 1 content",
      "Document 2 content",
      "Document 3 content"
    ];
  }
);

const documents = retriever("search query");

// Flush logs before exiting
await flush();
```

## API Reference

### log

```typescript
function log<T>(
  options: {
    name?: string;
    spanType?: "workflow" | "llm" | "retriever" | "tool";
    metadata?: Record<string, any>;
  },
  fn: (...args: any[]) => T
): (...args: any[]) => T
```

Wraps a function and logs its execution as a span.

#### Parameters

- `options`: Configuration options for the span
  - `name`: The name of the span
  - `spanType`: The type of span to create (default: "workflow")
  - `metadata`: Additional metadata to include in the span
- `fn`: The function to wrap

#### Returns

A wrapped function that, when called, will log its execution as a span.